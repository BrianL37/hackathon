<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TO-DO List with Calendar</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        transition: background-color 0.5s ease;
      }
      .color-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #007bff;
        color: white;
        border: none;
        padding: 15px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 16px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      }
      .color-button:hover {
        background-color: #0056b3;
      }
      #todo-container {
        margin: 20px;
      }
      #header {
        text-align: center;
      }
      .in-progress {
        color: orange;
      }
      .completed {
        color: green;
        text-decoration: line-through;
      }
      /* Calendar styling */
      #calendar {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px;
      }
      .calendar-header {
        display: flex;
        justify-content: space-between;
        width: 100%;
        margin-bottom: 10px;
      }
      .calendar-header button {
        padding: 10px;
        cursor: pointer;
      }
      .month-name {
        font-size: 1.5em;
      }
      .days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        grid-gap: 5px;
        width: 50%;
        margin-top: 20px;
      }
      .day {
        padding: 5px;
        cursor: pointer;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 5px;
        width: 60px;
        height: 60px;
        display: flex;
        justify-content: flex-start;
        align-items: flex-start;
        text-align: left;
        box-sizing: border-box;
      }
      .day:hover {
        background-color: #f0f0f0;
      }
      .task-input {
        margin-top: 20px;
        padding: 5px;
        font-size: 1em;
      }
      .task-list {
        margin-top: 10px;
        padding: 0;
        list-style: none;
      }
      .task {
        background-color: #e0e0e0;
        margin: 5px;
        padding: 5px;
        border-radius: 5px;
      }
      #todo-form {
        margin: 10px;
        text-align: center;
      }
      #todo-form input {
        padding: 5px;
        font-size: 1em;
      }
      .task-counters {
        margin-top: 10px;
        border-style: inset;
      }
    </style>
  </head>
  <body>
    <button class="color-button" onclick="changeBackgroundColor()">ðŸŽ¨</button>
    <div id="todo-container">
      <div id="header"><h1>To Do List</h1></div>
      <div id="todo-form">
        <input type="text" id="input-box" placeholder="Add Task" />
        <input type="date" id="date-box" />
        <button id="input-button" onclick="addTask()">Add Task</button>
      </div>
      <h2>Task List</h2>
      <ul id="list-container"></ul>
      <div class="counter-container">
        <div id="task-counters">
          In Progress: <span id="progress-counter">0</span> | Completed: <span id="completed-counter">0</span> | Uncompleted: <span id="uncompleted-counter">0</span>
        </div>
      </div>
    </div>

    <!-- Calendar Section -->
    <div id="calendar">
      <div class="calendar-header">
        <button onclick="changeMonth(-1)">&#8249;</button>
        <div class="month-name" id="month-name"></div>
        <button onclick="changeMonth(1)">&#8250;</button>
      </div>
      <div class="days" id="days"></div>
    </div>

    <script>
      const inputBox = document.getElementById("input-box");
      const dateBox = document.getElementById("date-box");
      const listContainer = document.getElementById("list-container");
      const progressCounter = document.getElementById("progress-counter");
      const completedCounter = document.getElementById("completed-counter");
      const uncompletedCounter = document.getElementById("uncompleted-counter");
      const daysElement = document.getElementById("days");
      const monthNameElement = document.getElementById("month-name");

      let currentDate = new Date();

      function updateCounters() {
        const tasks = listContainer.querySelectorAll("li");
        const inProgressTasks = listContainer.querySelectorAll(".in-progress");
        const completedTasks = listContainer.querySelectorAll(".completed");
        progressCounter.textContent = inProgressTasks.length;
        completedCounter.textContent = completedTasks.length;
        uncompletedCounter.textContent = tasks.length - inProgressTasks.length - completedTasks.length;
      }

      function addTask() {
        const task = inputBox.value.trim();
        const dueDate = dateBox.value;

        if (!task) {
          alert("Please write down a task");
          return;
        }

        // Add task to the general task list
        const li = document.createElement("li");
        li.innerHTML = `
          <span class="task-text" onclick="toggleStatus(this)">${task}</span>
          <span class="edit-btn" onclick="editTask(this)">Edit</span>
          <span class="delete-btn" onclick="deleteTask(this)">Delete</span>
        `;
        listContainer.appendChild(li);
        updateCounters();

        // Add task to the specific day box in the calendar (if a due date is provided)
        if (dueDate) {
          const selectedDate = new Date(dueDate);
          const dayElements = document.querySelectorAll(".day");
          const dayNumber = selectedDate.getDate();

          // Find the corresponding day box
          let taskAdded = false;
          dayElements.forEach((dayElement) => {
            if (parseInt(dayElement.innerText) === dayNumber) {
              const taskElement = document.createElement("div");
              taskElement.classList.add("task");
              taskElement.innerText = task;
              dayElement.appendChild(taskElement);
              taskAdded = true;
            }
          });

          if (!taskAdded) {
            alert("The selected date is not in the current month.");
          }
        }

        // Clear the input fields
        inputBox.value = "";
        dateBox.value = "";
      }

      function toggleStatus(taskText) {
        if (!taskText.classList.contains("in-progress") && !taskText.classList.contains("completed")) {
          taskText.classList.add("in-progress");
        } else if (taskText.classList.contains("in-progress")) {
          taskText.classList.remove("in-progress");
          taskText.classList.add("completed");
        } else {
          taskText.classList.remove("completed");
        }
        updateCounters();
      }

      function editTask(editButton) {
        const taskItem = editButton.parentElement;
        const taskText = taskItem.querySelector(".task-text").textContent;
        const newTask = prompt("Edit your task:", taskText);
        if (newTask !== null) {
          taskItem.querySelector(".task-text").textContent = newTask.trim();
        }
      }

      function deleteTask(deleteButton) {
        const taskItem = deleteButton.parentElement;
        listContainer.removeChild(taskItem);
        updateCounters();
      }

      function changeMonth(direction) {
        currentDate.setMonth(currentDate.getMonth() + direction);
        renderCalendar();
      }

      function renderCalendar() {
        const month = currentDate.getMonth();
        const year = currentDate.getFullYear();
        const firstDayOfMonth = new Date(year, month, 1);
        const lastDayOfMonth = new Date(year, month + 1, 0);
        const daysInMonth = lastDayOfMonth.getDate();

        monthNameElement.innerText = `${firstDayOfMonth.toLocaleString("default", { month: "long" })} ${year}`;
        daysElement.innerHTML = "";

        for (let i = 1; i <= daysInMonth; i++) {
          const dayElement = document.createElement("div");
          dayElement.classList.add("day");
          dayElement.innerText = i;

          dayElement.onclick = function () {
            dateBox.value = new Date(year, month, i).toISOString().split("T")[0];
          };

          daysElement.appendChild(dayElement);
        }
      }

      renderCalendar();
    </script>
  </body>
</html>
